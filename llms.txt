# MetAlyzer

**An R Package to read and analyze WebIDQ™ output**

The package provides methods to read output files from the WebIDQ™
software into R. Metabolomics data is read and reformatted into an S4
object for convenient data handling, statistics and downstream analysis.

## Install

There is a version available on CRAN.

``` r
install.packages("MetAlyzer")
```

For the latest version install from GitHub

``` r
library(devtools)
install_github("Lu-Group-UKHD/MetAlyzer")
```

## Quickstart

The package takes metabolomic measurements and the quantification status
(e.g. “Valid”, “LOQ”, “LOD”) as “.xlsx” files generated from the WebIDQ™
software. Additionally, meta data for each sample can be provided for
further analysis.

This is an extract from one of the provided example data sets.
![Example_Data](articles/images/biocrates_output.png)

#### Create MetAlyzer object:

``` r
> metalyzer_se <- MetAlyzer::read_webidq(file_path = load_demodata_biocrates())


 _____ ______   _______  _________  ________  ___           ___    ___ ________  _______   ________
|\   _ \  _   \|\  ___ \|\___   ___\\   __  \|\  \         |\  \  /  /|\_____  \|\  ___ \ |\   __  \
\ \  \\\__\ \  \ \   __/\|___ \  \_\ \  \|\  \ \  \        \ \  \/  / /\|___/  /\ \   __/|\ \  \|\  \
 \ \  \\|__| \  \ \  \_|/__  \ \  \ \ \   __  \ \  \        \ \    / /     /  / /\ \  \_|/_\ \   _  _\
  \ \  \    \ \  \ \  \_|\ \  \ \  \ \ \  \ \  \ \  \____    \/   / /     /  /_/__\ \  \_|\ \ \  \\  \| 
   \ \__\    \ \__\ \_______\  \ \__\ \ \__\ \__\ \_______\__/   / /     |\________\ \_______\ \__\\ _\ 
    \|__|     \|__|\|_______|   \|__|  \|__|\|__|\|_______|\____/ /       \|_______|\|_______|\|__|\|__|
                                                          \|____|/


Info: Reading color code "FFCBD2D7" as "#CBD2D7"
Info: Reading color code "FFB2D1DC" as "#B2D1DC"
Info: Reading color code "FF7FB2C5" as "#7FB2C5"
Info: Reading color code "FFB9DE83" as "#B9DE83"
Info: Reading color code "FFB9DE83" as "#B9DE83"
Info: Reading color code "FFFFF099" as "#FFF099"
Info: Reading color code "FFFFF099" as "#FFF099"
Info: Reading color code "FFA28BA3" as "#A28BA3"
Info: Reading color code "FFA28BA3" as "#A28BA3"
Info: Reading color code "FFB2D1DC" as "#B2D1DC"
Info: Reading color code "FF7FB2C5" as "#7FB2C5"

Measured concentration values:
------------------------------
          0%          25%          50%          75%         100% 
    0.000000     0.286299     1.289381     6.308854 12522.000000 

NAs: 762 (3.74%)


Measured quantification status:
-------------------------------
Valid: 15419 (75.66%)
LOQ: 983 (4.82%)
LOD: 3978 (19.52%)
NAs: 0 (0%)
```

### Visualizations:

The plotting functions plot_log2FC and plot_network can accept a
standard data frame containing log2FC results, and a stat column.

``` r
diffres_df <- readRDS(MetAlyzer::toy_diffres())
```

``` r
network <- MetAlyzer::plot_network(
  diffres_df,
  q_value = 0.05,
  metabolite_col = "Metabolite",
  values_col_name = "log2FC",
  stat_col_name = "qval",
  metabolite_text_size = 2,
  connection_width = 0.75,
  pathway_text_size = 4,
  pathway_width = 4,
)

network$Plot
```

![Network](articles/images/network_demodata.png)

Network

## Detailed instructions

**For a comprehensive tutorial, please check out the MetAlyzer
Vignettes**.  
**Please also check out [MetAlyzer on
CRAN](https://CRAN.R-project.org/package=MetAlyzer).**

# Package index

## All functions

- [`MetAlyzer_dataset()`](MetAlyzer_dataset.md) : Open file and read
  data
- [`aggregated_data()`](aggregated_data.md) : Get Aggregated Data
- [`calculate_conditional_mean()`](calculate_conditional_mean.md) :
  Helper function to calculate conditional mean based on significance
- [`calculate_node_aggregates_conditional()`](calculate_node_aggregates_conditional.md)
  : Calculate Node-Level Aggregate Statistics (Conditional on
  Significance)
- [`create_viridis_style()`](create_viridis_style.md) : Creates a
  viridis color style for Plotly plots.
- [`example_mutation_data_xl()`](example_mutation_data_xl.md) : Get
  example mutation data
- [`export_conc_values()`](export_conc_values.md) : Export filtered raw
  data as csv
- [`filter_meta_data()`](filter_meta_data.md) : Filter meta data
- [`filter_metabolites()`](filter_metabolites.md) : Filter metabolites
- [`load_demodata_biocrates()`](load_demodata_biocrates.md) : Get
  demodata from biocrates
- [`load_rawdata_extraction()`](load_rawdata_extraction.md) : Get
  example extraction data
- [`log2FC()`](log2FC.md) : Get log2FC Data
- [`metalyzer_colors()`](metalyzer_colors.md) : Get MetAlyzer colors
- [`pathway()`](pathway.md) : Get pathway file path
- [`plot_network()`](plot_network.md) : Plot Pathway Network
- [`plot_scatter()`](plot_scatter.md) : Scatter Plot Visualization
- [`polarity()`](polarity.md) : Get polarity file path
- [`read_edges()`](read_edges.md) : Read and Validate Network Edges
  (Connections)
- [`read_named_region()`](read_named_region.md) : Read Named Regions
- [`read_nodes()`](read_nodes.md) : Read and Validate Network Nodes
  (Metabolites)
- [`read_pathways()`](read_pathways.md) : Read and Validate Pathway
  Annotations
- [`read_webidq()`](read_webidq.md) : Open file and read data
- [`rename_meta_data()`](rename_meta_data.md) : Rename meta data
- [`save_plot()`](save_plot.md) : Save plots
- [`start_app()`](start_app.md) : Launch the Shiny App
- [`summarize_conc_values()`](summarize_conc_values.md) : Summarize
  concentration values
- [`summarize_quant_data()`](summarize_quant_data.md) : Summarize
  quantification status
- [`toy_diffres()`](toy_diffres.md) : Get example log2fc data
- [`update_meta_data()`](update_meta_data.md) : Update meta data

# Articles

### All vignettes

- [Standard Metabolomics](shiny_app.md):
- [R-package User Guide](user_guide.md):
